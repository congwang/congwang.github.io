---
categories:
- Programming
date: 2008-06-04 23:14:40-07:00
layout: post
permalink: /2008/06/04/utf-8%e7%89%88%e7%9a%84strlen/
title: UTF-8版的strlen
---
<p><br />

<p>在<a href="http://canonical.org/~kragen/strlen-utf8.html">这里</a>看到这么一个计算UTF-8字符串长度的程序：</p>
<p>[c]<br />
int my_strlen_utf8_c(char *s) {<br />
  int i = 0, j = 0;<br />
  while (s[i]) {<br />
    if ((s[i] &amp; 0xc0) != 0x80) j++;<br />
    i++;<br />
  }<br />
  return j;<br />
}<br />
[/c]</p>
<p>不解。查<a href="http://en.wikipedia.org/wiki/UTF-8">wikipedia</a>，得一表：<br />
00000000 00000000 0zzzzzzz	0zzzzzzz<br />
00000000 00000yyy yyzzzzzz	110yyyyy 10zzzzzz<br />
00000000 xxxxyyyy yyzzzzzz	1110xxxx 10yyyyyy 10zzzzzz<br />
000wwwxx xxxxyyyy yyzzzzzz	11110www 10xxxxxx 10yyyyyy 10zzzzzz</p>
<p>顿悟。</p>
<p></p>