---
layout: post
title: 共享上网和NFS
date: 2008-01-16 17:43:24.000000000 -08:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Linux Application
tags: []
meta:
  _publicize_pending: '1'
  original_post_id: '282'
  _wp_old_slug: '282'
author:
  login: wangcong2015
  email: wangcong@rocketmail.com
  display_name: wangcong2015
  first_name: ''
  last_name: ''
permalink: "/2008/01/16/%e5%85%b1%e4%ba%ab%e4%b8%8a%e7%bd%91%e5%92%8cnfs/"
---
<p><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"><br />
<html><body></p>
<p>有两台电脑，一个上网帐号，为了让两台电脑都能上网，得动手搭建一个小型局域网，“自己动手，丰衣足食”啊！前提是拨入网络的电脑必须配有两个网卡。</p>
<p>物理设备齐全后开始进行配置。先配置拨号的电脑（简称为S），两个网卡，一个用来拨号，一个用来和另一台电脑（简称为C）通信。eth0和ppp0就留作拨号，而eth1配置成192.168.1.1，和C连接。C的IP配置为192.168.1.2，网关为192.168.1.1。这还没完，此时C还够不到外网，必须还得用S做个代理，要是在Windows上恐怕得用sysgate了，可咱用的是Linux，两条命令搞定：</p>
<pre>
sudo /sbin/iptables -F #这个是把FC7自带的防火墙规则全部清掉

sudo /sbin/iptables -t nat -A POSTROUTING -o ppp0 -j MASQUERADE</pre>
<p>最后在C的/etc/resolv.conf里加上DNS服务器地址就可以了。这样，两台电脑上就能同时上网了。</p>
<p>这样还不够，虽然它们都能上网，可它们之间共享东西还不方便，那就开nfs吧！</p>
<p>NFS服务器还是在S上开，把属性设置成可写就是了。先编辑exports文件：</p>
<pre>
sudo vi /etc/exports</pre>
<p>内容如下：</p>
<pre>
/home/wangcong/ 192.168.1.2(rw,sync)</pre>
<p>然后开启NFS需要的服务：</p>
<pre>sudo /sbin/service rpcbind start</pre>
<pre>sudo /sbin/service nfslock start

sudo /sbin/service netfs start

sudo /sbin/service nfs start</pre>
<p>接下来是C主机，本以为直接mount就可以，谁知得到如下错误：</p>
<pre>
$ sudo mount 192.168.1.1:/home/wangcong /mnt</pre>
<pre>mount.nfs: rpc.statd is not running but is required for remote locking

Either use "-o nolocks" to keep locks local, or start statd.</pre>
<p>经过尝试，原来还需要开启nfslock和rpcbind，打开就是了：</p>
<pre>
sudo /sbin/service rpcbind start</pre>
<pre>sudo /sbin/service nfslock start</pre>
<p>这样再mount就可以使用NFS了。</body></html></p>
