---
categories:
- Programming
date: 2009-12-28 12:10:15-08:00
layout: post
permalink: /2009/12/28/%e8%8e%b7%e5%8f%96c%e8%af%ad%e8%a8%80%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b%e5%a4%a7%e5%b0%8f/
title: 获取C语言数据类型大小
---
<p><br />

<p>一个简单的脚本，可以在命令行下获取C语言中数据类型的大小。在邮件列表的讨论中看到的这个主意，我用 Perl 重写了一下。</p>
<p>代码很简单，见下。分享一下，希望对你有用。<br />
[perl]<br />
#!/usr/bin/perl -w</p>
<p>use strict;<br />
use File::Temp qw/tempfile tempdir/;</p>
<p>die "Wrong usage.n" unless @ARGV == 1;<br />
my $type=$ARGV[0];<br />
my $dir = tempdir(CLEANUP =&gt; 1);<br />
my ($obj, $src) = tempfile("$dir/XXXXX", SUFFIX =&gt; '.c', UNLINK =&gt; 0);<br />
open my $fd, "&gt;$src" or die "can't create file: $!";<br />
$src =~ s/.c$//g;<br />
my $exe_file = $src;</p>
<p>print $fd &lt;&lt;eof;<br />
#include<br />
#include<br />
#include<br />
#include<br />
#include<br />
#include<br />
#include<br />
#include<br />
#include<br />
#include<br />
#include<br />
#include<br />
#include<br />
int<br />
main (void)<br />
{<br />
  $type x;<br />
  printf ("%d\n", sizeof x);<br />
  exit (0);<br />
}<br />
EOF<br />
my $result = qx(gcc -o $exe_file $exe_file.c &amp;&amp; $exe_file);<br />
print $result;<br />
[/perl]</p>
<p></p>