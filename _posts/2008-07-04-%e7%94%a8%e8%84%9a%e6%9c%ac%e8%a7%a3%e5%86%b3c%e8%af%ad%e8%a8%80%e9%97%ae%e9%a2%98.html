---
layout: post
title: 用脚本解决C语言问题
date: 2008-07-04 01:32:04.000000000 -07:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Programming
tags: []
meta:
  _publicize_pending: '1'
  original_post_id: '366'
  _wp_old_slug: '366'
author:
  login: wangcong2015
  email: wangcong@rocketmail.com
  display_name: wangcong2015
  first_name: ''
  last_name: ''
permalink: "/2008/07/04/%e7%94%a8%e8%84%9a%e6%9c%ac%e8%a7%a3%e5%86%b3c%e8%af%ad%e8%a8%80%e9%97%ae%e9%a2%98/"
---
<p><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"><br />
<html><body><br />
<a href="http://vvoody.org/">vvoody</a>在<a href="http://groups.google.com/group/xiyoulinux?hl=zh-CN">xiyoulinux</a>上提出了<a href="http://groups.google.com/group/xiyoulinux/browse_thread/thread/31149c640d00f165">一个C语言的问题</a>，这个问题我之前见过，所以不想自己想了，想让计算机帮我完成。于是费了一番功夫写了个脚本帮我完成。（哎，老了，写代码慢了～～）</p>
<p>先贴“答案”，应该是总共8个结果（下面的9个中有两个明显是等价的）：</p>
<p>int *i,n=99;main(){for(i=0;i&lt;n;i--){printf("#");}}<br />
int i,*n=99;main(){for(i=0;i&lt;n;i--){printf("#");}}<br />
int i,n=99;main(){for(i=0;-i&lt;n;i--){printf("#");}}<br />
int i,n=99;main(){for(i=0;~i&lt;n;i--){printf("#");}}<br />
int i,n=99;main(){for(i=0;i&lt;&amp;n;i--){printf("#");}}<br />
int i,n=99;main(){for(i=0;i&lt;n;i--);{printf("#");}}<br />
int*i,n=99;main(){for(i=0;i&lt;n;i--){printf("#");}}<br />
int i,n=99;main(){for(i=0;i+n;i--){printf("#");}}<br />
int i,n=99;main(){for(i=0;i&lt;n;n--){printf("#");}}</p>
<p>用时：</p>
<p>real    1m3.881s<br />
user    0m44.097s<br />
sys     0m17.436s</p>
<p>最让我吃惊的结果是那个溢出的，很巧妙，脚本运行到那里停了大约4，5秒钟的样子。</p>
<p>最后放脚本，包括两部分，一部分用bash完成，另一部分用Perl完成。其实完全用bash或者完全用Perl都是可行的，而且完全用Perl应该是最快的。</p>
<p>[bash]<br />
#!/bin/bash</p>
<p>TEST_VAR='int i,n=99;main(){for(i=0;i&lt;n;i--){printf("#");}}'</p>
<p>#Generated by Python with<br />
#''.join(map(lambda x: '' if chr(x).isupper() else chr(x), range(32, 127)))<br />
#except '$','(',')', '{','}', '[', ']', '@', "`", """, "#", "'", "\", ' '<br />
possible_chars='!'"%&amp;*+,-./0123456789:;?^_abcdefghijklmnopqrstuvwxyz|~"<br />
len=${#TEST_VAR}<br />
num_chars=${#possible_chars}<br />
tmpfile=$(mktemp /tmp/test-$$.XXXXXXX)<br />
outfile="/tmp/test_sh.out"</p>
<p>function is_valid_and_ok()<br />
{<br />
	echo $1 &gt; $tmpfile<br />
	if gcc -xc -c -o $outfile.o $tmpfile &amp;&gt;/dev/null;<br />
	then<br />
		gcc -o $outfile $outfile.o &amp;&gt;/dev/null<br />
		if [[ $? -ne 0 ]]; then<br />
			return 0<br />
		fi<br />
		#nohup $outfile &gt; $resultfile 2&gt; /dev/null &amp;<br />
		#sleep 1 &amp;&amp; killall $outfile 2&gt; /dev/null<br />
		n=$(./get_run_result.pl $outfile)<br />
		echo $n<br />
		if [[ $n -eq 99 ]] || [[ $n -eq 100 ]] || [[ $n -eq 1 ]]<br />
		then<br />
			return 1<br />
		fi<br />
	fi<br />
	return 0<br />
}</p>
<p>#main<br />
i=8<br />
while(($i $tmp" 1&gt;&amp;2<br />
	fi<br />
	i=$(($i+1))<br />
done;</p>
<p>i=4<br />
while (($i &lt; $len - 14));<br />
do<br />
	j=0<br />
	while(($j $tmp" 1&gt;&amp;2<br />
		fi<br />
		j=$(($j+1))<br />
	done<br />
	i=$(($i+1))<br />
	if (($i == 11)) ; then<br />
		i=17<br />
	fi<br />
done;</p>
<p>i=0<br />
while(($i&lt;$len - 16));<br />
do<br />
	j=0<br />
	while(($j $tmp" 1&gt;&amp;2<br />
		fi<br />
		j=$(($j+1))<br />
	done<br />
	i=$(($i+1))<br />
	if (($i == 11)) ; then<br />
		i=17<br />
	fi<br />
done;<br />
[/bash]<br />
[perl]<br />
#!/usr/bin/perl -w</p>
<p>use strict;<br />
use warnings;</p>
<p>my $n;<br />
my $chars;</p>
<p>open(my $in_file, "$ARGV[0]|") or exit 1;<br />
$n = read($in_file, $chars, 101);<br />
print "$nn";<br />
close $in_file;<br />
[/perl] </body></html></p>
