---
categories:
- Linux Application
date: 2012-10-11 15:21:14-07:00
layout: post
permalink: /2012/10/11/%e7%94%a8-scapy-%e5%8f%91%e9%80%81-vlan-%e5%8c%85%e7%9a%84%e4%be%8b%e5%ad%90/
title: 用 scapy 发送 vlan 包的例子
---
<p><br />
<br />
<a href="http://www.secdev.org/projects/scapy/">scapy</a> 绝对是你应该学习的一大利器，功能十分强大，把 Python 的优势发挥的淋漓尽致。用它发送定制的数据包比你用C写快好几个数量级。。。</p>
<p>下面是我在测试前面文章中的 vlan 问题时发送带指定 vlan tag 的 arp request，不到10行代码就可以搞定！</p>
<p>[python]<br />
#!/usr/bin/python</p>
<p>import sys<br />
from scapy.all import *</p>
<p>mac="52:54:00:2E:23:92"<br />
eth=Ether(src=mac,type=0x8100)/Dot1Q(vlan=int(sys.argv[1]), prio=5)<br />
arp=ARP(hwtype=0x0001,ptype=0x0800,op=0x0001,hwsrc=mac,psrc='192.168.122.1',pdst='192.168.122.74')<br />
a=eth/arp<br />
a.show()<br />
sendp(a, iface="virbr0")</p>
<p>[/python] </p>