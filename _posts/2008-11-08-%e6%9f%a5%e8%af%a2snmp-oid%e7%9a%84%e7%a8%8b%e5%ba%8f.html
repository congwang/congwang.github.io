---
layout: post
title: 查询SNMP OID的程序
date: 2008-11-08 09:03:14.000000000 -08:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Programming
tags: []
meta:
  _publicize_pending: '1'
  original_post_id: '416'
  _wp_old_slug: '416'
author:
  login: wangcong2015
  email: wangcong@rocketmail.com
  display_name: wangcong2015
  first_name: ''
  last_name: ''
permalink: "/2008/11/08/%e6%9f%a5%e8%af%a2snmp-oid%e7%9a%84%e7%a8%8b%e5%ba%8f/"
---
<p><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"><br />
<html><body>
<p>网上有个查询的网站，可惜什么结果都查不出来！靠！我实在看不下去了，动手写一个python程序来搞定，不过仍有局限性，那就是只能查询.iso.org子树。。。啥也不说了，上代码！</p>
<p>[python]<br />
#!/usr/bin/env python</p>
<p>import os,sys<br />
import string<br />
import re<br />
import urllib2</p>
<p>if __name__ == '__main__':</p>
<p>	if len(sys.argv) != 2:<br />
		sys.stderr.write("Please provide one OID number or string to lookup.n");<br />
		sys.exit(1)</p>
<p>	flag = 0<br />
	found = False</p>
<p>	r = re.compile('^[0-9\.]+$')<br />
	if r.match(sys.argv[1]):<br />
		r = re.compile('^1\.3')<br />
		if r.match(sys.argv[1]):<br />
			flag = 1<br />
		else:<br />
			sys.stderr.write("Please provide the full OID number under .iso.org!n")<br />
			sys.exit(1)</p>
<p>	try:<br />
		req = urllib2.Request('http://www.kix.in/plan9/mirror/sources/contrib/gabidiaz/root/lib/ndb/snmp')<br />
		resp = urllib2.urlopen(req)<br />
		oid = resp.readline()<br />
		name = resp.readline()<br />
		while oid and name:<br />
			if flag == 1:<br />
				if oid.find(sys.argv[1]) != -1:<br />
					print name<br />
					found = True<br />
					break<br />
			else:<br />
				n = name.lower().find(sys.argv[1].lower())<br />
				if n != -1:<br />
					print oid<br />
					found = True<br />
					if n+len(sys.argv[1]) &lt; len(name)-1:<br />
						print name<br />
			oid = resp.readline()<br />
			name = resp.readline()<br />
		if not found:<br />
			print "Not found!"<br />
		sys.exit(0)<br />
	except IOError:<br />
		sys.stderr.write("Probably you don't have Internet.n")<br />
		sys.exit(1)</p>
<p>[/python] </p>
<p></body></html></p>
