---
layout: post
title: virtual function 的例子
date: 2009-02-01 23:58:33.000000000 -08:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Programming
tags: []
meta:
  _publicize_pending: '1'
  original_post_id: '541'
  _wp_old_slug: '541'
author:
  login: wangcong2015
  email: wangcong@rocketmail.com
  display_name: wangcong2015
  first_name: ''
  last_name: ''
permalink: "/2009/02/01/virtual-function-%e7%9a%84%e4%be%8b%e5%ad%90/"
---
<p><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"><br />
<html><body>
<p>本来这没什么可说的，C++中的虚函数不难理解，可是我看到不少教程中的例子给得不行，多说一句得。</p>
<p>那些教程给出的是类似下面的例子：</p>
<p>Base *p = new Derived;<br />
p-&gt;virt_func();</p>
<p>我认为这个例子不行，只能显示虚函数啥样子，却不能说明白为什么要有虚函数。其实，至少我认为，虚函数是为了给函数传递参数用的，我使用基类指针作为函数参数类型的定义，但调用时却可以传递给它子类的指针，可虚函数的行为却是实参类型中的对应方法。我认为这才是虚函数的意义，为此我写了下面一个程序，顺便练练了刚学成的template recursion。</p>
<p>[cpp]<br />
#include </p>
<p>template<br />
class C: public C<br />
{<br />
	public:<br />
		virtual void foo();<br />
};</p>
<p>template<br />
void C::foo()<br />
{<br />
	std::cout&lt;&lt;id&lt;&lt;std::endl;<br />
}</p>
<p>template<br />
class C<br />
{<br />
	public:<br />
		virtual void foo();<br />
};</p>
<p>void C::foo()<br />
{<br />
	std::cout&lt;&lt;0&lt;&lt;std::endl;<br />
}</p>
<p>void func(C *arg)<br />
{<br />
	arg-&gt;foo();<br />
}</p>
<p>int main()<br />
{<br />
	C C1;<br />
	C C2;<br />
	C C3;</p>
<p>	func(&amp;C1);<br />
	func(&amp;C2);<br />
	func(&amp;C3);<br />
	return 0;<br />
}<br />
[/cpp] </p>
<p></body></html></p>
